import React, { createContext, useContext, useEffect, useMemo, useState } from 'react'

const LANGUAGE_STORAGE_KEY = 'app-language'

export const availableLanguages = [
  { code: 'en', label: 'English' },
  { code: 'ru', label: 'Русский' },
  { code: 'kk', label: 'Қазақша' },
]

const messages = {
  en: {
    English: 'English',
    Русский: 'Russian',
    Қазақша: 'Kazakh',
    'Qonaq Invite': 'Qonaq Invite',
    Templates: 'Templates',
    Editor: 'Editor',
    Analytics: 'Analytics',
    'Login / Register': 'Login / Register',
    Logout: 'Logout',
    Language: 'Language',
    'Design invitations that set the tone': 'Design invitations that set the tone',
    'Explore editorial-style templates curated with vibrant photography. Personalize every detail and share a stunning invite in minutes.':
      'Explore editorial-style templates curated with vibrant photography. Personalize every detail and share a stunning invite in minutes.',
    'Loading templates...': 'Loading templates...',
    'We could not load templates right now. Please try again shortly.': 'We could not load templates right now. Please try again shortly.',
    'No templates are available just yet - check back soon!': 'No templates are available just yet - check back soon!',
    'Tip:': 'Tip:',
    'Log in to upload photos and save every version of your design.': 'Log in to upload photos and save every version of your design.',
    'Start designing': 'Start designing',
    'Canvas size': 'Canvas size',
    'Add Text': 'Add Text',
    'Add Photo': 'Add Photo',
    'Add GIF': 'Add GIF',
    'Background Photo': 'Background Photo',
    Background: 'Background',
    'Reset Background': 'Reset Background',
    'Export PNG': 'Export PNG',
    Save: 'Save',
    Layers: 'Layers',
    'Text Layer': 'Text Layer',
    'Image Layer': 'Image Layer',
    'GIF Layer': 'GIF Layer',
    'Reorder, hide, or remove items.': 'Reorder, hide, or remove items.',
    Text: 'Text',
    Image: 'Image',
    GIF: 'GIF',
    Up: 'Up',
    Down: 'Down',
    Hide: 'Hide',
    Show: 'Show',
    Delete: 'Delete',
    'Template default': 'Template default',
    Custom: 'Custom',
    'Bring forward': 'Bring forward',
    'Send backward': 'Send backward',
    'Toggle visibility': 'Toggle visibility',
    'Add text or images to manage layers.': 'Add text or images to manage layers.',
    'Double-click to edit': 'Double-click to edit',
    'Login required to upload to the server. Used a local copy instead.': 'Login required to upload to the server. Used a local copy instead.',
    'Upload failed - used a local copy instead.': 'Upload failed - used a local copy instead.',
    'Login required to upload backgrounds. Using a local background instead.': 'Login required to upload backgrounds. Using a local background instead.',
    'Background upload failed - using a local background instead.': 'Background upload failed - using a local background instead.',
    'Unable to load that image. Please try a different file.': 'Unable to load that image. Please try a different file.',
    'Unable to load that background. Please try another image.': 'Unable to load that background. Please try another image.',
    'Unable to add that GIF. Please try another one.': 'Unable to add that GIF. Please try another one.',
    'Unable to restore the template background right now.': 'Unable to restore the template background right now.',
    'Unable to load GIFs. Please try again.': 'Unable to load GIFs. Please try again.',
    'Select a GIF': 'Select a GIF',
    Close: 'Close',
    'Search celebration GIFs': 'Search celebration GIFs',
    Search: 'Search',
    'GIF option': 'GIF option',
    'Insert GIF': 'Insert GIF',
    'Loading GIFs...': 'Loading GIFs...',
    'No results. Try a different search term.': 'No results. Try a different search term.',
    'You are invited!': 'You are invited!',
    'Tell us if you can make it!': 'Tell us if you can make it!',
    'Your saved designs': 'Your saved designs',
    'Loading designs...': 'Loading designs...',
    "You haven't saved any designs yet.": "You haven't saved any designs yet.",
    'Guest responses': 'Guest responses',
    'Share the RSVP link so guests can leave their details.': 'Share the RSVP link so guests can leave their details.',
    'Copy link': 'Copy link',
    'Copied!': 'Copied!',
    'Copy failed': 'Copy failed',
    'Copy not supported': 'Copy not supported',
    'Loading responses...': 'Loading responses...',
    'No one has responded yet.': 'No one has responded yet.',
    'Refresh responses': 'Refresh responses',
    'Invitation design': 'Invitation design',
    'RSVP page': 'RSVP page',
    'Select a template to get started': 'Select a template to get started',
    'Head back to the template gallery to choose a design. Your picks automatically appear here.':
      'Head back to the template gallery to choose a design. Your picks automatically appear here.',
    'Guest list': 'Guest list',
    'Track invited guests and confirmations manually.': 'Track invited guests and confirmations manually.',
    'Save your design before adding guests.': 'Save your design before adding guests.',
    'Guest name': 'Guest name',
    'Contact info (optional)': 'Contact info (optional)',
    'Comment (optional)': 'Comment (optional)',
    'Mark as confirmed': 'Mark as confirmed',
    'Adding...': 'Adding...',
    'Add guest': 'Add guest',
    'Refreshing...': 'Refreshing...',
    'Refresh guests': 'Refresh guests',
    guest: 'guest',
    guests: 'guests',
    'Loading guests...': 'Loading guests...',
    'No guests yet. Add your first invitee above.': 'No guests yet. Add your first invitee above.',
    Confirmed: 'Confirmed',
    Pending: 'Pending',
    'Contact info': 'Contact info',
    Comment: 'Comment',
    'Saving...': 'Saving...',
    Cancel: 'Cancel',
    'Mark pending': 'Mark pending',
    'Mark confirmed': 'Mark confirmed',
    'Edit details': 'Edit details',
    'Remove guest prompt': 'Remove {name}?',
    'Unable to add guest right now.': 'Unable to add guest right now.',
    'Guest name is required.': 'Guest name is required.',
    'Guest name cannot be empty.': 'Guest name cannot be empty.',
    'Unable to update guest.': 'Unable to update guest.',
    'Unable to update guest status.': 'Unable to update guest status.',
    'Unable to delete guest.': 'Unable to delete guest.',
  },
  ru: {
    English: 'Английский',
    Русский: 'Русский',
    Қазақша: 'Казахский',
    'Qonaq Invite': 'Qonaq Invite',
    Templates: 'Шаблоны',
    Editor: 'Редактор',
    Analytics: 'Аналитика',
    'Login / Register': 'Войти / Регистрация',
    Logout: 'Выйти',
    Language: 'Язык',
    'Design invitations that set the tone': 'Создайте приглашения, задающие настроение',
    'Explore editorial-style templates curated with vibrant photography. Personalize every detail and share a stunning invite in minutes.':
      'Изучите редакционные шаблоны с яркими фото. Настройте детали и поделитесь приглашением за минуты.',
    'Loading templates...': 'Загружаем шаблоны...',
    'We could not load templates right now. Please try again shortly.': 'Не удалось загрузить шаблоны. Попробуйте позже.',
    'No templates are available just yet - check back soon!': 'Шаблонов пока нет — загляните позже!',
    'Tip:': 'Подсказка:',
    'Log in to upload photos and save every version of your design.': 'Войдите, чтобы загружать фото и сохранять версии дизайна.',
    'Start designing': 'Начать дизайн',
    'Canvas size': 'Размер макета',
    'Add Text': 'Добавить текст',
    'Add Photo': 'Добавить фото',
    'Add GIF': 'Добавить GIF',
    'Background Photo': 'Фон как фото',
    Background: 'Цвет фона',
    'Reset Background': 'Сбросить фон',
    'Export PNG': 'Экспорт PNG',
    Save: 'Сохранить',
    Layers: 'Слои',
    'Text Layer': 'Текстовый слой',
    'Image Layer': 'Слой изображения',
    'GIF Layer': 'GIF-слой',
    'Reorder, hide, or remove items.': 'Упорядочивайте, скрывайте или удаляйте элементы.',
    Text: 'Текст',
    Image: 'Изображение',
    GIF: 'GIF',
    Up: 'Вверх',
    Down: 'Вниз',
    Hide: 'Скрыть',
    Show: 'Показать',
    Delete: 'Удалить',
    'Template default': 'Размер шаблона',
    Custom: 'Пользовательский',
    'Bring forward': 'Выше',
    'Send backward': 'Ниже',
    'Toggle visibility': 'Переключить видимость',
    'Add text or images to manage layers.': 'Добавьте текст или изображения, чтобы управлять слоями.',
    'Double-click to edit': 'Дважды щёлкните для редактирования',
    'Login required to upload to the server. Used a local copy instead.': 'Нужен вход для загрузки на сервер. Использована локальная копия.',
    'Upload failed - used a local copy instead.': 'Загрузка не удалась — использована локальная копия.',
    'Login required to upload backgrounds. Using a local background instead.': 'Для загрузки фона требуется вход. Использован локальный фон.',
    'Background upload failed - using a local background instead.': 'Загрузка фона не удалась — используем локальный фон.',
    'Unable to load that image. Please try a different file.': 'Не удалось загрузить изображение. Попробуйте другой файл.',
    'Unable to load that background. Please try another image.': 'Не удалось загрузить фон. Попробуйте другое изображение.',
    'Unable to add that GIF. Please try another one.': 'Не удалось добавить этот GIF. Попробуйте другой.',
    'Unable to restore the template background right now.': 'Не удалось восстановить фон шаблона.',
    'Unable to load GIFs. Please try again.': 'Не удалось загрузить GIF. Попробуйте снова.',
    'Select a GIF': 'Выберите GIF',
    Close: 'Закрыть',
    'Search celebration GIFs': 'Поиск праздничных GIF',
    Search: 'Поиск',
    'GIF option': 'Вариант GIF',
    'Insert GIF': 'Вставить GIF',
    'Loading GIFs...': 'Загружаем GIF...',
    'No results. Try a different search term.': 'Нет результатов. Попробуйте другой запрос.',
    'You are invited!': 'Вы приглашены!',
    'Tell us if you can make it!': 'Сообщите, получится ли прийти!',
    'Your saved designs': 'Ваши сохранённые дизайны',
    'Loading designs...': 'Загружаем дизайны...',
    "You haven't saved any designs yet.": 'Вы ещё не сохранили ни одного дизайна.',
    'Guest responses': 'Ответы гостей',
    'Share the RSVP link so guests can leave their details.': 'Поделитесь ссылкой RSVP, чтобы гости оставили данные.',
    'Copy link': 'Скопировать ссылку',
    'Copied!': 'Скопировано!',
    'Copy failed': 'Не удалось скопировать',
    'Copy not supported': 'Копирование недоступно',
    'Loading responses...': 'Загружаем ответы...',
    'No one has responded yet.': 'Пока нет ответов.',
    'Refresh responses': 'Обновить ответы',
    'Invitation design': 'Дизайн приглашения',
    'RSVP page': 'Страница RSVP',
    'Select a template to get started': 'Выберите шаблон, чтобы начать',
    'Head back to the template gallery to choose a design. Your picks automatically appear here.':
      'Вернитесь в галерею шаблонов и выберите дизайн. Ваш выбор появится здесь автоматически.',
    'Guest list': 'Список гостей',
    'Track invited guests and confirmations manually.': 'Отслеживайте гостей и подтверждения вручную.',
    'Save your design before adding guests.': 'Сохраните дизайн перед добавлением гостей.',
    'Guest name': 'Имя гостя',
    'Contact info (optional)': 'Контакты (необязательно)',
    'Comment (optional)': 'Комментарий (необязательно)',
    'Mark as confirmed': 'Отметить подтверждённым',
    'Adding...': 'Добавляем...',
    'Add guest': 'Добавить гостя',
    'Refreshing...': 'Обновляем...',
    'Refresh guests': 'Обновить список',
    guest: 'гость',
    guests: 'гостей',
    'Loading guests...': 'Загружаем гостей...',
    'No guests yet. Add your first invitee above.': 'Гостей пока нет. Добавьте первого приглашённого выше.',
    Confirmed: 'Подтверждён',
    Pending: 'В ожидании',
    'Contact info': 'Контакты',
    Comment: 'Комментарий',
    'Saving...': 'Сохраняем...',
    Cancel: 'Отмена',
    'Mark pending': 'Отметить как ожидающего',
    'Mark confirmed': 'Отметить подтверждённым',
    'Edit details': 'Редактировать данные',
    'Remove guest prompt': 'Удалить {name}?',
    'Unable to add guest right now.': 'Не удалось добавить гостя.',
    'Guest name is required.': 'Имя гостя обязательно.',
    'Guest name cannot be empty.': 'Имя гостя не может быть пустым.',
    'Unable to update guest.': 'Не удалось обновить гостя.',
    'Unable to update guest status.': 'Не удалось обновить статус гостя.',
    'Unable to delete guest.': 'Не удалось удалить гостя.',
  },
  kk: {
    English: 'Ағылшын',
    Русский: 'Орыс',
    Қазақша: 'Қазақша',
    'Qonaq Invite': 'Qonaq Invite',
    Templates: 'Үлгілер',
    Editor: 'Редактор',
    Analytics: 'Аналитика',
    'Login / Register': 'Кіру / Тіркелу',
    Logout: 'Шығу',
    Language: 'Тіл',
    'Design invitations that set the tone': 'Көңіл-күйді көтеретін шақыру жасаңыз',
    'Explore editorial-style templates curated with vibrant photography. Personalize every detail and share a stunning invite in minutes.':
      'Жарқын фотосуреттері бар шаблондарды қараңыз. Әр бөлшекті баптап, бірнеше минутта керемет шақыру жіберіңіз.',
    'Loading templates...': 'Үлгілер жүктелуде...',
    'We could not load templates right now. Please try again shortly.': 'Үлгілерді қазір жүктеу мүмкін емес. Кейінірек қайталап көріңіз.',
    'No templates are available just yet - check back soon!': 'Үлгілер әзірге жоқ — кейінірек оралыңыз!',
    'Tip:': 'Кеңес:',
    'Log in to upload photos and save every version of your design.': 'Фото жүктеп, дизайн нұсқаларын сақтау үшін кіріңіз.',
    'Start designing': 'Дизайнды бастау',
    'Canvas size': 'Полотно өлшемі',
    'Add Text': 'Мәтін қосу',
    'Add Photo': 'Фото қосу',
    'Add GIF': 'GIF қосу',
    'Background Photo': 'Фон суреті',
    Background: 'Фон түсі',
    'Reset Background': 'Фонды қалпына келтіру',
    'Export PNG': 'PNG экспорттау',
    Save: 'Сақтау',
    Layers: 'Қабаттар',
    'Text Layer': 'Мәтін қабаты',
    'Image Layer': 'Сурет қабаты',
    'GIF Layer': 'GIF қабаты',
    'Reorder, hide, or remove items.': 'Элементтердің ретін өзгертіп, жасырыңыз немесе өшіріңіз.',
    Text: 'Мәтін',
    Image: 'Сурет',
    GIF: 'GIF',
    Up: 'Жоғары',
    Down: 'Төмен',
    Hide: 'Жасыру',
    Show: 'Көрсету',
    Delete: 'Өшіру',
    'Template default': 'Үлгінің өлшемі',
    Custom: 'Пайдаланушы',
    'Bring forward': 'Алға жылжыту',
    'Send backward': 'Артқа жылжыту',
    'Toggle visibility': 'Көрсет/жасыру',
    'Add text or images to manage layers.': 'Қабаттарды басқару үшін мәтін немесе сурет қосыңыз.',
    'Double-click to edit': 'Өзгерту үшін екі рет басыңыз',
    'Login required to upload to the server. Used a local copy instead.': 'Серверге жүктеу үшін кіру қажет. Жергілікті көшірме қолданылды.',
    'Upload failed - used a local copy instead.': 'Жүктеу сәтсіз — жергілікті көшірме қолданылды.',
    'Login required to upload backgrounds. Using a local background instead.': 'Фон жүктеу үшін кіру қажет. Жергілікті фон қолданылды.',
    'Background upload failed - using a local background instead.': 'Фон жүктеу сәтсіз — жергілікті фон қолданылды.',
    'Unable to load that image. Please try a different file.': 'Бұл суретті жүктеу мүмкін болмады. Басқа файл таңдаңыз.',
    'Unable to load that background. Please try another image.': 'Бұл фонды жүктеу мүмкін болмады. Басқа суретті көріп көріңіз.',
    'Unable to add that GIF. Please try another one.': 'GIF қосу мүмкін болмады. Басқасын таңдаңыз.',
    'Unable to restore the template background right now.': 'Фонды қалпына келтіру әзірге мүмкін емес.',
    'Unable to load GIFs. Please try again.': 'GIF жүктеу мүмкін болмады. Қайта көріңіз.',
    'Select a GIF': 'GIF таңдаңыз',
    Close: 'Жабу',
    'Search celebration GIFs': 'Мерекелік GIF іздеу',
    Search: 'Іздеу',
    'GIF option': 'GIF нұсқасы',
    'Insert GIF': 'GIF қосу',
    'Loading GIFs...': 'GIF жүктелуде...',
    'No results. Try a different search term.': 'Нәтиже табылмады. Басқа сөз тіркесін қолданып көріңіз.',
    'You are invited!': 'Сіз шақырылдыңыз!',
    'Tell us if you can make it!': 'Келетініңізді хабарлаңыз!',
    'Your saved designs': 'Сақталған дизайндар',
    'Loading designs...': 'Дизайндар жүктелуде...',
    "You haven't saved any designs yet.": 'Әзірге дизайн сақталмаған.',
    'Guest responses': 'Қонақ жауаптары',
    'Share the RSVP link so guests can leave their details.': 'Қонақтар деректерін қалдыруы үшін RSVP сілтемесін бөлісіңіз.',
    'Copy link': 'Сілтемені көшіру',
    'Copied!': 'Көшірілді!',
    'Copy failed': 'Көшіру сәтсіз',
    'Copy not supported': 'Көшіру қолдау таппайды',
    'Loading responses...': 'Жауаптар жүктелуде...',
    'No one has responded yet.': 'Әзірге жауап жоқ.',
    'Refresh responses': 'Жауаптарды жаңарту',
    'Invitation design': 'Шақыру дизайны',
    'RSVP page': 'RSVP беті',
    'Select a template to get started': 'Бастау үшін шаблон таңдаңыз',
    'Head back to the template gallery to choose a design. Your picks automatically appear here.':
      'Шаблон галереясына оралып, дизайн таңдаңыз. Таңдауыңыз осында автоматты түрде көрінеді.',
    'Guest list': 'Қонақтар тізімі',
    'Track invited guests and confirmations manually.': 'Шақырылған қонақтарды және растауларды қолмен жүргізіңіз.',
    'Save your design before adding guests.': 'Қонақтарды қоспас бұрын дизайнды сақтаңыз.',
    'Guest name': 'Қонақтың аты',
    'Contact info (optional)': 'Байланыс (қалауыңызша)',
    'Comment (optional)': 'Пікір (қалауыңызша)',
    'Mark as confirmed': 'Расталды деп белгілеу',
    'Adding...': 'Қосылып жатыр...',
    'Add guest': 'Қонақ қосу',
    'Refreshing...': 'Жаңартылып жатыр...',
    'Refresh guests': 'Қонақтарды жаңарту',
    guest: 'қонақ',
    guests: 'қонақтар',
    'Loading guests...': 'Қонақтар жүктелуде...',
    'No guests yet. Add your first invitee above.': 'Қонақтар әлі жоқ. Алғашқы қонақты жоғарыдан қосыңыз.',
    Confirmed: 'Расталды',
    Pending: 'Күтілуде',
    'Contact info': 'Байланыс',
    Comment: 'Пікір',
    'Saving...': 'Сақталып жатыр...',
    Cancel: 'Болдырмау',
    'Mark pending': 'Күтілуде деп белгілеу',
    'Mark confirmed': 'Расталды деп белгілеу',
    'Edit details': 'Мәліметтерді өңдеу',
    'Remove guest prompt': '{name} қонағын өшіреміз бе?',
    'Unable to add guest right now.': 'Қонақты қосу әзірге мүмкін емес.',
    'Guest name is required.': 'Қонақтың аты қажет.',
    'Guest name cannot be empty.': 'Қонақтың аты бос болмауы тиіс.',
    'Unable to update guest.': 'Қонақты жаңарту мүмкін болмады.',
    'Unable to update guest status.': 'Қонақ мәртебесін жаңарту мүмкін болмады.',
    'Unable to delete guest.': 'Қонақты жою мүмкін болмады.',
  },
}

const I18nContext = createContext({
  language: 'en',
  t: (key, fallback) => fallback ?? key,
  setLanguage: () => {},
})

export function I18nProvider({ children }) {
  const [language, setLanguage] = useState(() => {
    const stored = typeof window !== 'undefined' ? localStorage.getItem(LANGUAGE_STORAGE_KEY) : null
    return stored || 'en'
  })

  useEffect(() => {
    if (typeof window !== 'undefined') {
      localStorage.setItem(LANGUAGE_STORAGE_KEY, language)
    }
  }, [language])

  const value = useMemo(() => {
    const translate = (key, fallback) => {
      const bucket = messages[language] || messages.en
      if (bucket && Object.prototype.hasOwnProperty.call(bucket, key)) {
        return bucket[key]
      }
      if (messages.en && Object.prototype.hasOwnProperty.call(messages.en, key)) {
        return messages.en[key]
      }
      return fallback ?? key
    }

    return {
      language,
      setLanguage,
      t: translate,
      languages: availableLanguages,
    }
  }, [language])

  return React.createElement(I18nContext.Provider, { value }, children)
}

export const useI18n = () => useContext(I18nContext)
